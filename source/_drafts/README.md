---
title: Problems in Developing WebRTC iOS Demo
date: 2018-09-03
categories: WebRTC
tags: [Demo,Note]
---

ç”¨WebRTCå®ç°iOSç«¯çš„å¤šæ–¹é€šè¯

<!---more--->

å¼€å‘å†å²

> 2018.09.12 å‘¨ä¸‰

- å¼€å§‹ã€‚

  ä¹‹å‰ç¼–è¯‘æœ‰é—®é¢˜ã€‚ç‹å«è€å¸ˆé‡å†™äº†ä¸€ä»½ç»™æˆ‘ã€‚

  è°ƒç”¨SocketRocketåº“è¿æ¥åˆ°æœåŠ¡å™¨ä¸Šã€‚è¿æ¥æˆåŠŸã€‚

> 09.13 å‘¨å››

- ç»™æœåŠ¡å™¨å‘jsonæ ¼å¼çš„NSStringå¯¹è±¡ã€‚æœåŠ¡å™¨æ²¡æœ‰ååº”ã€‚

  æ¯æ¬¡éƒ½æ˜¯å‘é€äº†messageç»™æœåŠ¡å™¨ä¹‹åï¼Œæ‰è¾“å‡ºWebSocket Connectedã€‚

  æŠŠå‘é€messageæ”¾åˆ°webSocketDidOpenä¹‹åå‘ã€‚æˆåŠŸã€‚

> 09.14 å‘¨äº”

- åˆçº§ç•Œé¢é—®é¢˜ã€‚ViewControleré‡Œæƒ³ç”¨Appdelegateçš„å¯¹è±¡ã€‚æˆ‘åªèƒ½è°ƒAppdelegateçš„æ–¹æ³•ã€‚

> 09.17 å‘¨ä¸€

- è°ƒAppDelegateçš„é—®é¢˜è§£å†³äº†ã€‚åŸæ¥æ˜¯æœåŠ¡å™¨æ ¼å¼è¦æ±‚jsonåŒ…é‡Œæœ‰ä¸ªå­—æ¯è¦å¤§å†™ã€‚ç»†å¿ƒå•Šï¼

> 09.18 å‘¨äºŒ

- æ”¹å˜æ ¸å¿ƒä»»åŠ¡ã€‚å…ˆæ‰“é€šä¿¡ä»¤ï¼

- å¯ä»¥ç¦»å¼€æˆ¿é—´å…³é—­socketäº†ã€‚æœ€ç®€å•çš„åŠ å…¥å’Œç¦»å¼€å¯ä»¥ä¹‹åã€‚è¦åšé€»è¾‘å¤æ‚çš„PeerConnectionå’ŒRoomManageräº†ã€‚

> 09.19 å‘¨ä¸‰

- åœ¨AppDelegateä¸­åˆ›å»ºParticipateå¯¹è±¡ã€‚å°†å®¢æˆ·ç«¯å‘é€å’Œæ¥å—ç”¨çš„æ–¹æ³•å…¨éƒ¨åœ¨å†™Appdelegateã€‚

  ViewControlerä½¿ç”¨æ—¶å†è°ƒç”¨ã€‚

- å­—å…¸å­˜æ”¾Participateç±»å¯¹è±¡

> 09.20 å‘¨å››

- ä»Šå¤©æ•ˆç‡æ¯”è¾ƒé«˜ã€‚å†™ä»£ç å¾ˆé¡ºã€‚å¯¹ç…§Kurentoçš„jsæ–‡ä»¶ã€‚å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨äº¤äº’çš„ä¿¡ä»¤åŸºæœ¬æ‰“é€šã€‚
- å‰©ä¸‹æœ€å‘çš„å°±æ˜¯è°ƒå®˜æ–¹åº“çš„æ—¶å€™äº†ã€‚
- ä¸€ç›´æ¥ä¸åˆ°participantLeftçš„ä¿¡ä»¤ã€‚æ‰¾äº†å¼ºå“¥ã€‚çœ‹æœåŠ¡å™¨çš„Javaä»£ç ã€‚æœ€åå‘ç°ä¸å»ºç«‹RTCPeeræ˜¯ä¸ç»™æˆ‘å‘è¿™æ¡ä¿¡ä»¤çš„ã€‚

> 09.25 å‘¨äºŒ

- ä¸­ç§‹å°å‡å½’æ¥ã€‚ä»Šå¤©å…ˆçœ‹å®˜æ–¹Demo: APPRTCã€‚

> 09.26 å‘¨ä¸‰

- Participateç±»ä¸­åŠ å…¥äº†PeerConnectionå’ŒICECandidateã€‚æœ‰é—®é¢˜ï¼ŒICecandidateåˆå§‹åŒ–æ‡µäº†ã€‚è„‘å­æœ‰ç‚¹ä¹±ã€‚

> 09.27 å‘¨å››

- å‡†å¤‡å°†å‘é€çš„åŒ…ä»NSStringè½¬æˆNSDataï¼Œå…ˆè¯•ä¸€ä¸‹æœåŠ¡å™¨é‚£è¾¹èƒ½ä¸èƒ½å¤„ç†NSDateã€‚
  - å¤±è´¥ã€‚å‘Dataå°±åªèƒ½å‘Dataã€‚åè€Œè´¹äº‹äº†ã€‚è€è€å®å®ç”¨Stringå§ã€‚å‘Stringåªæ˜¯Dictionaryè½¬Stringç¨å¾®å¤šå‡ å¥ã€‚
- å¼€å§‹ç ”ç©¶è°ƒç”¨å®˜æ–¹åº“ï¼Œå¤šæ¬¡å°è¯•è¿è¡ŒæŠ¥é”™ã€‚

> 09.28 å‘¨äº”

- frameworkçš„åº“ä¸ä¼šä½¿ç”¨ã€‚ç½‘ä¸Šä¸‹åˆ°ä¸€ä¸ª.açš„åº“ï¼ŒæŠ¥é”™

> 10.08 å‘¨ä¸€

- å›½åº†å½’æ¥

- ç ”ç©¶.aé™æ€åº“çš„ç¼–è¯‘ï¼Œå‚è€ƒè¿™ç¯‡æ–‡ç« https://www.jianshu.com/p/2ecb9d846b35

  å‘ç°æˆ‘æ‰‹ä¸Šçš„è¿™ä»½æºç å¥½åƒä¸æ”¯æŒï¼Œåœ¨`webrtc_build/webrtc/src/tools_webrtc/ios/build_ios_libs.py `æ–‡ä»¶çš„é…ç½®é€‰é¡¹é‡Œæ²¡æœ‰`static_only`

  å¼€å§‹ç¼–è¯‘Frameworkã€‚ç¼–è¯‘å¥½å‘ç°ä¸ä¼šå¯¼å…¥åˆ°å·¥ç¨‹é‡Œç”¨ã€‚importä¸å‡ºæ¥ã€‚æ”¾åˆ°å­ç›®å½•é‡Œå¯ä»¥`#import "WebRTC.framework/Headers/xxx.h"`ï¼Œä½†è¿™æ ·è‚¯å®šä¸æ­£å®—å•Šï¼

> 10.09 å‘¨äºŒ

- ç»ˆäºä¼šç”¨WebRTC.frameworkäº†ã€‚ä¸¤ä¸ªè¦ç‚¹ï¼š

  - ç›´æ¥æŠŠWebRTC.frameworkæ‹–åˆ°Embbded Binaries

  - > `#import "WebRTC/RTCVideoTrack.h" ` è¿™ä¹ˆå¼•å…¥å°±å¯ä»¥ã€‚â€”â€”ç‹å«è€å¸ˆ

    æˆ‘æŠ˜è…¾äº†è¿™ä¹ˆå¤šå¤©éƒ½çŸ¥é“æ˜¯è¿™ä¹ˆå¼•ç”¨çš„ğŸ˜‚ ç¡®å®ï¼Œäººå®¶å®˜æ–¹çš„APPRTC demoä¸å°±æ˜¯è¿™æ ·å¼•å…¥çš„å—ï¼Ÿç»ˆäºå¯ä»¥å¼€å·¥äº†ã€‚

> 10.17 å‘¨ä¸‰

- è°ƒç”¨å®˜æ–¹åº“åå‚è€ƒå¤šä¸ªiOS Demoï¼Œæ²¡æœ‰å®è´¨è¿›å±•ã€‚

  å› ä¸ºå‚è€ƒKurentoå®˜æ–¹çš„jsç‰ˆä»£ç ï¼Œæ ¸å¿ƒæ–‡ä»¶é€»è¾‘å¤æ‚ã€‚

- ä»Šå¤©å¼€å§‹ï¼Œæˆ‘ä¹Ÿå°è£…ä¸€ä¸ªRTCPeerConnectionClientã€‚

  æœªæ¥çš„å‡ å¤©å°±å¹²è¿™ä¸ªäº‹ã€‚

> 10.25 å‘¨å››

- ä»¿å†™RTCPeerConnectionClientæœ‰å›°éš¾ã€‚Android Demoé‡Œæœ‰çš„ä»£ç ä¸çŸ¥é“å¯¹åº”OCæ˜¯ä»€ä¹ˆåŠŸèƒ½ã€‚ï¼ˆJavaå’ŒOCéƒ½ä¸ä¼šï¼‰
- é¼“æ£äº†ä¸€å‘¨äº†åˆå¼€å§‹æƒ³ä»¿å†™å®˜æ–¹Demoäº†ã€‚ä¸çŸ¥é“çŸ­æœŸçš„å°ç›®æ ‡æ˜¯ä»€ä¹ˆã€‚å»ºç«‹peerConnectionçš„è¿‡ç¨‹è¦ä¹ˆå°±æ˜¯ä¸€æ¬¡æ€§æ‰“é€šï¼Œè¦ä¹ˆå°±å•¥ä¹Ÿæ²¡æœ‰ï¼Œæ€ä¹ˆè¿›å±•å‘¢ï¼Ÿ

> 10.26 å‘¨äº”

- RTCPariç±»åœ¨æˆ‘çš„åº“é‡Œå·²ç»æ²¡æœ‰äº†ã€‚è®¾ç½®Constraintsçš„æ–¹æ³•æ˜¯é€šè¿‡å­—å…¸

  æˆ‘æš‚æ—¶æŠŠä¼ Constraintsçš„å‚æ•°çš„åœ°æ–¹å…¨è®¾nilï¼Œç»§ç»­å¾€ä¸‹å¼€å‘

> 10.30 å‘¨äºŒ

- æ‘„åƒå¤´è·å–æƒé™æ²¡é—®é¢˜äº†ã€‚æ¨¡æ‹Ÿå™¨åŸæ¥ä¸èƒ½æ‰“å¼€æ‘„åƒå¤´
- VideoCapturerçš„ç±»æœ‰ä¸¤ä¸ªï¼Œä¹Ÿæ²¡çœ‹æ˜ç™½æ€ä¹ˆç”¨ï¼Œå‡†å¤‡è·³è¿‡äº†

> 10.31 å‘¨ä¸‰

- APPRTCã€Androidå’ŒKurentoä¸‰ç§Demoçœ‹çš„çœ¼èŠ±ç¼­ä¹±äº†ã€‚
- åˆä¼¼æ˜¯è€Œéåœ°æ„Ÿè§‰å†…å¿ƒæœ‰ä¸€ç‚¹ç‚¹é€»è¾‘äº†ã€‚ä½†æ˜¯ä»”ç»†æƒ³æƒ³ä¸€ä¸‹æˆ‘è¦æ€ä¹ˆç»§ç»­ï¼Œåˆè§‰å¾—å¥½å‡Œä¹±ã€‚ä¸»è¦æ˜¯åº“é‡Œçš„æ–¹æ³•ä¸ä¼šç”¨å•Šã€‚å¾ˆå¤šOCçš„å…³é”®å­—æˆ‘å¹¶ä¸çŸ¥é“å®ƒæ˜¯ä»€ä¹ˆä½œç”¨ã€‚ç‚¸é”…ã€‚

> 11.1 å‘¨å››

- 11æœˆ æ–°å¼€å§‹ã€‚å¸Œæœ›ä»Šå¤©ä¸€åˆ‡é¡ºåˆ©ã€‚